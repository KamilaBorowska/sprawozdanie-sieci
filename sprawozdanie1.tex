% -*- latex -*-
% spr.tex

% Wymagane pola:
% - Imie Nazwisko
% - grupa (dzin+godzina zaj.)
% - Nazwa i numer cwiczenia)
% - data

% Wymagane jest umieszczenie źródeł sprawozdania (plik *.tex, źródła rysunków)
% w ktalogu ~/labsk. Pliki tekstowe muszą byc w formacie pl_PL.UTF-8
% (nie wiem jak plik tekstowy może być w formacie pl_PL, to jest locale,
%  chyba chodziło po prostu o UTF-8?)

% Wymagany jest wydruk z obu stron kartki!
\documentclass[a4paper,11pt]{article}

\usepackage{polski}
\usepackage[utf8]{inputenc}     % niepotrzebne gdy pierwsza linia pliku to "%& --translate-file=il2-pl"

\hoffset=-3.0cm                 % Mniejszy lewy margines
\textwidth=18cm                 % szerzej
\evensidemargin=0pt

\voffset=-3cm                   % Mniejszy gorny margines
\textheight=27cm                % szerzej wzdluz

\setlength{\parindent}{0pt}             % No paragraph indentation
\setlength{\parskip}{\medskipamount}    % Space between paragraphs
\raggedbottom                           % bez rozciagania strony

\title{Sprawozdanie z sieci -- ćwiczenie 0~i~1\\Poniedziałek, 10:00}
\author{Konrad Borowski\\Paweł Szczepanowski}

\begin{document}
\thispagestyle{empty}                   % bez numeracji stron

\maketitle

\section{Cel}

Celem zadania była nauka podstawowych poleceń systemu Unix, nauka
konfiguracji maszyn wirtualnych i~ich konfiguracja, obsługa systemu
X~Window System (przez tunel SSH), protokołów VNC i~RDP.

\section{Realizacja}

\subsection{SSH}

Protokoł SSH pozwala na połączenia zaszyfrowane z~innym komputerem. Zwykle
jest on używany do obsługi linii poleceń, ale można korzystać też z~tego
protokołu do przesyłania plików za pomocą \verb|scp| czy innych zastosowań,
takich jak użycie protokołu ssh przez program \verb|git|.

Kryptografia to skomplikowany temat, więc nie będzie on wyjaśniony w~pełni.
Jednakże, w~dużym skrócie, protokoł SSH korzysta z~kryptografii asymetrycznej.
Serwer SSH z~którym klient się łączy przedstawia swój klucz publiczny. Ten
klucz powinien być już znany przez klienta w~celu zweryfikowania tożsamości,
jeżeli ten klucz nagle się zmieni, to prawdopodobnie wystąpił atak (lub
administrator serwera zapomniał o~robieniu kopii zapasowych i~stracił
klucz prywatny serwera). Klucz ten też jest wykorzystywany przez klienta
do szyfrowania wiadomości do serwera. Następnie, klient może przesłać swój
klucz publiczny, tak aby serwer mógł zaszyfrować wiadomości do klienta.

Klucz publiczny nie musi istnieć po stronie klienta, może być wygenerowany
dokładnie kiedy jest potrzebny na jedną sesję, ale jeżeli istnieje, może
być użyty przez serwer do rozpoznania użytkownika bez potrzeby logowania.

\subsection{X Window System}

Protokoł X~Window System jest protokołem który miał na celu umożliwienie
korzystania z~aplikacji graficznych uruchomionych na innym komputerze.
Pozwalało to na uruchomienie aplikacji (klienta) na jednym komputerze,
bez obciążania tego komputera wyświetlaniem tej grafiki -- zamiast tego,
serwer (komputer z~podłączonym monitorem) był odpowiedzialny za to.

Ta funkcjonalność jest rzadko wykorzystawana dzisiaj. Zwykle serwer
i~klienci są uruchomieni na tej samej maszynie, co jest jak najbardziej
możliwe przy mocy obliczeniowych procesorów (i~karty graficznej). Nie
mniej jednak, jest częścią laboratorium.

\subsection{Virtual Network Computing}

Protokoł ten jest protokołem przesyłania filmów na żywo z~możliwością
przesyłania naciśniętych przycisków na klawiaturze i~ruchów myszki.
Przesyłanie filmu zwykle jednak znaczy przesyłanie sesji graficznej.
Można korzystać z~tego protokołu z~możliwością korzystania klawiatury
i~myszki, lub bez niej, co jest przydatne gdy na przykład użytkownik
chce pokazać innym swoją sesję graficzną.

\subsection{Remote Desktop Protocol}

Nie wiem jak to działa. Powiem więcej -- nie mam prawa wiedzieć jak to działa.
Jest to opatentowany i~w~teorii tajny protokoł Microsoftu. Nie mniej jednak,
protokoł jest podobny do VNC w~stopniu w~którym mogę z~niego korzystać.

\subsection{VirtualBox}

VirtualBox to maszyna wirtualna która pozwala na uruchamianie systemów
operacyjnych kiedy system operacyjny jest włączony. Implementacja jest
w~dużej części intuicyjna, jednakże włączenie sieciowego systemu operacyjnego
w~sieci ZETIS wymaga włączenia mostkowania w~celu udostępnienia dostępu
do sieci lokalnej i~włączenia własnościowych dodatków do VirtualBox,
zamiast korzystania z~systemu NAT.

\section{Algorytm}

\subsection{SSH}

\begin{itemize}

\item Tworzenie pary kluczów prywatnego i~publicznego

\begin{verbatim}
$ ssh-keygen 
Generating public/private rsa key pair.
Enter file in which to save the key (/home/xfix/.ssh/id_rsa): 
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /home/xfix/.ssh/id_rsa.
Your public key has been saved in /home/xfix/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:Fg8i9p7DYA6SSU5Mc7DnYc+ccQHg7ncHDzZWsE22pPA xfix@orange
The key's randomart image is:
+---[RSA 2048]----+
| +.o.o.o +       |
|o =   o X .      |
| = =o..Eo+       |
|+o=.=o+..+       |
|+..oo=.*S .      |
| ..+ +oo=        |
|   ...=. o       |
|    . ...        |
|                 |
+----[SHA256]-----+
\end{verbatim}

\item Przesyłanie klucza publicznego na inny komputer. Polecenie
\verb|ssh-copy-id| automatycznie zapisuje klucz publiczny
w~\verb|~/.ssh/authorized_keys|, z~którego to serwer SSH odczytuje
listę kluczy które mają dostęp bez podawania hasła (w~przypadku
włączenia takiej funkcjonalności).

\begin{verbatim}
$ ssh-copy-id volt
Password: 
Now try logging into the machine, with "ssh 'volt'", and check in:

  ~/.ssh/authorized_keys

to make sure we haven't added extra keys that you weren't expecting.
\end{verbatim}

\item Logowanie w~celu sprawdzenia poprawności konfiguracji.

\begin{verbatim}
k2% ssh volt
Last login: Sun Apr  2 21:14:43 2017 from vol
...
volt%
\end{verbatim}

\end{itemize}

\subsection{X~Window System (tunel ssh)}

\begin{itemize}

\item Logowanie SSH z~użyciem opcji \verb|-Y|, umożliwiającej przekierowanie X11
    z~autoryzacją.

\begin{verbatim}
$ ssh -Y szczepp3@volt.iem.pw.edu.pl
\end{verbatim}

\item Uruchomienie programu, na przykład \verb|xcalc|.

\begin{verbatim}
volt% xcalc
\end{verbatim}

\end{itemize}

\subsection{X~Window System (bezpośredni protokoł X Window z~wykorzystaniem xauth)}

\begin{itemize}

\item Wyświetlenie listy ciasteczek X~Window.

\begin{verbatim}
k5% xauth list
k5/unix:0  MIT-MAGIC-COOKIE-1  b138356d5c3af2dc894fcb11dd0c5ca
\end{verbatim}

\item Udostępnienie klucza komputerowi na którym będzie uruchamiany klient X.
      W~tym wypadku \verb|:0| to numer ekranu serwera X, a ciąg zaczynający
      się od \verb|b138| jest kluczem wyświetlanym przez \verb|xauth list|.

\begin{verbatim}
volt% xauth add :0 . b138356d5c3af2dc894fcb11dd0c5ca
\end{verbatim}

\item Uruchomienie programu w~celu przetestowania konfiguracji.

\begin{verbatim}
volt% xcalc
\end{verbatim}


\end{itemize}

\section{Scenariusze}

\end{document}